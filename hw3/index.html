<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CS 184 - HW 3</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="a8fe6e88-7ef6-41e8-bfb4-3e59c33b663f" class="page sans"><header><h1 class="page-title">CS 184 - HW 3</h1><p class="page-description"></p></header><div class="page-body"><p id="7c1ad14c-b8e8-4dad-9fd7-e3004221b07d" class="">
</p><p id="561743fd-972c-451b-9985-d5477c0ed5d0" class="">Webpage: </p><h2 id="8bdee4c4-28f5-410d-93ea-5044411b139e" class="">Overview</h2><p id="b660e947-03aa-49a6-85d7-ba7a6d6f6e1b" class="block-color-default">In this project, we generated rays from a camera and shot them through a scene. We tested for ray intersections using bounding boxes and BVH Acceleration to optimize the process. In order to do this, we had to test for intersections of primitive shapes like triangles and spheres. Then we calculated irradiance and illumination to properly render light in our scene. The 2 different processes were Uniform Hemisphere Sampling and Importance Sampling. Then we applied Adaptive Sampling to get the pixels to converge quickly.</p><h2 id="34b33f2e-a07d-4d1a-97cb-799d577ef940" class="">Part 1: Ray Generation and Scene Intersection</h2><h3 id="1b822bbc-7d28-43ee-a634-3e112d1a382d" class="">Ray Generation and Primitive Intersection</h3><p id="dd640ba6-f6f4-4a8d-a50e-2526755ca171" class="block-color-default">In order to generate rays, we converted the Vector2D (x,y) coordinate pairs from image space to its corresponding Vector3D (x,y,z) position in camera space.  Next we calculated the ray direction by taking the difference between Vector3D(x,y, -1) position in camera space and the origin (Zero vector). The direction was then transformed into world space with the given c2w matrix, normalized, and finally intialized into a ray that was outputted from generate_ray(). </p><p id="c969cfc3-aa8d-44ad-b660-a8d0c44b5516" class="">Inside raytrace_pixel(), we called passed in the normalized x and y to <code>generate_ray()</code> to create a ray and take its average estimated radiance over <code>ns_aa</code> iterations to update the pixel with <code>avgRadiance</code>.</p><h3 id="db8acb0f-4cce-470c-8619-bf78fdc41e4c" class="">Triangle Intersection Algorithm</h3><p id="00dd1178-be8f-41a4-97a0-984c3b40fa6b" class="block-color-default">The triangle intersection algorithm that we implemented was the <mark class="highlight-yellow_background">Moller Trumbore Algorithm</mark>. This algorithm takes the 3 vertices of a triangle to compute the 2 edges (or vectors i.e. <code>E1</code> and <code>E2</code>) that are adjacent to 1 target vertex. Those are then used with our known <strong>ray origin</strong> <code>r.o</code> and <strong>ray direction</strong> <code>r.d</code> vectors to find the incident vectors <code>S0</code>, <code>S1</code>, and <code>S2</code>, along with the target vertex, to find the value of <code>t</code> that the ray intersects the triangle and the <strong>barycentric coefficients</strong> <code>b0</code>, <code>b1</code>, and <code>b2</code>.</p><p id="ad688dcf-91ad-4c6f-88f6-b850ae00f417" class="">We then took <code>t</code> and compared its value to the <strong>ray’s minimum</strong> and <strong>maximum t range</strong>. If it was <code>[r.min_t, r.max_t]</code>, we deemed that the ray intersected the triangle. We also checked the barycentric coefficient values to make sure their values were within the range of 0 and 1.</p><figure id="f19e236f-577e-458c-8779-be0db7cfc153" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Untitled.png"><img style="width:1440px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Untitled.png"/></a></figure><h3 id="39b193e6-c807-4ad9-b8e5-1e034999f4ef" class="">Sphere Intersection Algorithm</h3><p id="b3bc6901-1c40-4d4d-bb8d-f8fead7477b0" class="">For the sphere, we checked if it intersected the ray by first computing the <strong>normal vector of the sphere</strong> (the ray’s origin - the sphere’s origin). Then we calculated the <strong>determinant of the quadratic formula</strong> by finding the values of a, b, and c relative to the sphere. <code>a = dot(r.d, r.d)</code> <code>b = dot(2.0f * (originMinusCenter), r.d)</code> <code>c = dot(originMinusCenter, originMinusCenter) - r2</code> If the determinant was less than 0.0f, there was no intersection. Otherwise, there was an intersection.</p><p id="175536a4-9cf0-4f5d-b3dc-e792832093cc" class="">In the intersect function, we checked for an intersection. If the ray did intersect the sphere, we solved the quadratic equation to obtain the value of t. If t was within ray <code>min_t</code> and <code>max_t</code>, we <strong>updated the intersection’s parameters</strong>. If t was less than ray <code>max_t</code>, we <strong>updated the value of </strong><code>max_t</code>.</p><h3 id="df07a373-89eb-4cc5-be09-3c7bbe99d534" class="">Images</h3><div id="b0de5bab-1c61-4050-b5e2-45197a8b2f96" class="column-list"><div id="b0957b4e-6b3e-496c-95ec-fe9e63f5626d" style="width:50%" class="column"><figure id="00d3034c-9560-47d2-afde-43a685b80f62" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Cube.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Cube.png"/></a></figure><figure id="39b0bc87-ca6c-48ed-96c0-8fbbfc8e7cab" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBempty.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBempty.png"/></a></figure></div><div id="185e3092-9d38-4288-a86e-15088eff16ee" style="width:50%" class="column"><figure id="11f5ba65-6bb3-4b9d-80be-7460fbff6545" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Plane.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/Plane.png"/></a></figure><figure id="76555b2f-f723-446b-9ffd-d428322cb28b" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres.png"/></a></figure></div></div><h2 id="3f87dd60-abed-4e96-a66c-df199433d3ac" class="">Part 2: Bounding Volume Hierarchy</h2><h3 id="477f7a2a-3476-4374-b131-ecc3ed30f8c9" class="">BVH Construction Algo</h3><p id="308da71c-4a80-40dc-9b84-2be41e96543f" class="block-color-default">Our BVH construction algorithm starts by iterating through the list of primitives to create a BBox node. If the number of primitives in the BBox were less than or equal to the <code>max_leaf_size</code>, we set the node’s start and end pointers to the list of primitives and the left and right children to <code>NULL</code>. </p><p id="cb9e2178-8142-4f0e-bd2c-fef7dc327cb1" class="">Otherwise, we looked for the <strong>split axis</strong> by comparing the axes extent values and took the greatest one. We then sorted the list of primitives according to their centroid values on the split axis in ascending order. We chose our <strong>split point</strong> to be the <mark class="highlight-yellow_background">midpoint of the axis</mark>. Using this, we reiterated through the list of primitives and placed a pointer at the middle. The middle pointer was then used to recursively construct the BVH nodes for this interior node’s left and right children.</p><h3 id="7bf65a77-4324-4bc7-8630-9af2531ffb3c" class="">Images</h3><figure id="71d4a3cc-7f3f-4541-987c-c77d4c98f39f" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/cow.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/cow.png"/></a></figure><figure id="52ac650e-ff13-4b49-bed2-970131a0a59c" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/maxplanck.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/maxplanck.png"/></a></figure><figure id="0509656e-26b9-4e63-be67-b410dc2ea928" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBlucy_pt2.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBlucy_pt2.png"/></a></figure><figure id="81eb0b5c-9b04-436d-8b08-7fb48edb83ed" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/peter.png"><img style="width:800px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/peter.png"/></a></figure><h3 id="ac5bd94b-d28d-475d-9ef8-6134427bb6aa" class="">Rendering Time Comparisons</h3><ul id="dcb41774-69db-4529-b66d-bb9849521918" class="block-color-default bulleted-list"><li style="list-style-type:disc">cow: 0.4818s → 0.1354s</li></ul><ul id="a343549f-ced3-41b9-8527-75fa8b4a3e0b" class="block-color-default bulleted-list"><li style="list-style-type:disc">maxplanck: 0.7618s → 0.2348s</li></ul><ul id="dcc60d2f-74de-4d2c-a612-40a344b9fb31" class="bulleted-list"><li style="list-style-type:disc">CBlucy: 0.2806s → 0.0711s</li></ul><ul id="c9d5cab2-7159-49ae-b98f-a447dc4c93a9" class="bulleted-list"><li style="list-style-type:disc">peter: 0.5594s → 0.1742s</li></ul><p id="41277cdc-1e7a-4336-aeb9-4e43683008a3" class="">The renders without BVH Acceleration were significantly slower than the renders with it. This is due to the computational efficiency that BVH Acceleration offers. Since we’re using bounding boxes to quickly identify intersections based on the split axis and point instead of iterating through the entire list of primitives each time, we are saved lots of computation.</p><h2 id="e83e19c2-14d2-4e1a-b29c-83e1cf7dd1c5" class="">Part 3: Direct Illumination</h2><p id="1e8d26b0-3d90-4a2e-973c-8ec68dea97e9" class=""><span style="border-bottom:0.05em solid">Direct Lighting with Uniform Hemisphere Sampling</span></p><p id="1436a54c-1b13-4811-91f8-ff10a7bb5bad" class="">This function calculates the amount of lighting that hits <code>hit_p</code> by sampling rays in its hemisphere and incorporating it in to the <mark class="highlight-yellow_background">Monte Carlo estimate</mark>. For the estimate, we calculated the light reflected in the <code>w_out</code> direction by using the <code>bsdf→f()</code> function we wrote back in 3.1 and for the amount of incoming light, we used <code>get_emission()</code> on the object the ray intersected.</p><p id="5053d754-aac0-48dc-ad6b-e9898d26d3de" class=""><span style="border-bottom:0.05em solid">Direct Lighting by Importance Sampling Lights</span></p><p id="5afb41fb-2d8a-4824-a475-a0be992d5f8f" class="">Unlike uniform hemisphere lighting, importance sampling derives its samples from the light sources in the image. If the light source is a point, only one sample is taken. This sample gives us <code>w_i</code>, the <code>distance to the light</code>, and the <code>pdf</code>. We use these values to create a Ray and set  <code>min_t = ESP_F</code> and <code>max_t = dist2light - EPS_F</code>, in order to detect whether not there’s an intersection before the ray reaches the light. If there’s no intermediate intersection, that means the light directly hits the point. In this case, we can calculate the irradiance the same way as we did with Uniform Hemisphere Sampling by using the reflectance equation. The biggest difference is that we must <strong>divide by </strong><code>pdf</code> to account for the weight of that singular sample.</p><h3 id="e9d8fd99-f5ad-4a81-8e55-b9e065e1cbba" class="">Images</h3><figure id="deaf3203-a64e-462e-8a3e-7b2bcf268ca6" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_16_8.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_16_8.png"/></a><figcaption>Zero Bounce Radiance</figcaption></figure><p id="d6412b84-b071-4b15-b3b7-34de865e63b9" class="">Uniform Hemisphere Sampling</p><figure id="a35099a2-3259-456f-8160-85a141ee03c5" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_H_16_8_pt3_3.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_H_16_8_pt3_3.png"/></a><figcaption>-t 8 -s 16 -l 8 | 14.5232s</figcaption></figure><figure id="214de5d4-6d3b-4dab-b1a3-98e4d228fcec" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_H_64_32_pt3_3.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBbunny_H_64_32_pt3_3.png"/></a><figcaption>-t 8 -s 64 -l 32 -m 6 | 165.6317s</figcaption></figure><p id="0289bc8b-e274-47c8-967f-6944881ab0e5" class="">Importance Sampling</p><figure id="8dc150ee-8050-43f9-94f4-4d8bc0ec6d13" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_1_1_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_1_1_pt3_4.png"/></a><figcaption>-t 8 -s 1 -l 1 -m 1 -f | 0.1884s</figcaption></figure><figure id="69b9f4c2-8122-47d3-b514-c5b8b5076c1e" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_64_32_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_64_32_pt3_4.png"/></a><figcaption>-t 8 -s 64 -l 32 -m 6 -f | 71.5473s</figcaption></figure><figure id="c58f508b-4bed-4013-8d80-248aad7d6443" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/dragon_64_32_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/dragon_64_32_pt3_4.png"/></a><figcaption>-t 8 -s 64 -l 32 -m 6 -f | 196.0982s</figcaption></figure><h3 id="6e24832a-f920-4658-a134-c21be582558a" class="">Light Ray Case Study: CBspheres_lambertian.dae</h3><div id="917c42ec-f567-480c-b1a7-9f311f3a7410" class="column-list"><div id="17d2a00c-e2c3-45ac-9152-e98d78e28d1c" style="width:50%" class="column"><figure id="435c545a-6096-4049-a9cf-1d509ea60c24" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_1_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_1_pt3_4.png"/></a><figcaption>-s 1 -l 1</figcaption></figure><figure id="176a2a32-24c8-497f-853e-03ddfe49f67f" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_16_pt3_4.png"><img style="width:318.5px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_16_pt3_4.png"/></a><figcaption>-s 1 -l 16</figcaption></figure></div><div id="cea40ad6-1406-49e6-a930-5e27408fbfcf" style="width:50%" class="column"><figure id="cd8f224f-f5d9-4726-99a5-d5ec76e5b53e" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_4_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_4_pt3_4.png"/></a><figcaption>-s 1 -l 4</figcaption></figure><figure id="3206c611-6393-4cca-80d5-6a2c51411130" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_64_pt3_4.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/CBspheres_lambertian_1_64_pt3_4.png"/></a><figcaption>-s 1 -l 64</figcaption></figure></div></div><p id="9bac0270-6070-4b2d-b416-453dbc8a02a3" class="">Noise has an indirect relationship with the number of samples per area light.</p><h3 id="2295f773-3e31-4cd6-b045-c081d7ea436c" class="">Comparison</h3><p id="002efeca-612e-46bb-a081-e14108e2e010" class="">Generally, images rendered using Uniform Hemisphere Sampling were noisier than images rendered using Importance Sampling. There’s also less “glare” or blurred white pixels around the light source in importance sampled images than uniform hemisphere sampled images.</p><h2 id="cfe128fd-873a-4de6-8668-bb5ff9bc808c" class=""><strong>Part 5: Adaptive Sampling</strong></h2><p id="25a5060c-afc8-483d-920c-b277202108b4" class="">Adaptive sampling sums up the illumination values of each sample and returns after the convergence threshold is met. This is done in order to stop extra computation (i.e. the pixel has already reached convergence and doesn’t need to have any more samples taken). The convergence value is <code>1.96 * (standard deviation / square root of number of samples)</code> and the threshold is <code>maxTolerance * mean</code>.</p><figure id="c8f7c4c7-b3be-4a96-9231-b34ddadce5f3" class="image"><a href="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_pt5_rate.png"><img style="width:480px" src="CS%20184%20-%20HW%203%20a8fe6e887ef641e8bfb43e59c33b663f/bunny_pt5_rate.png"/></a></figure></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>